{% extends '../../layouts/dashboard' %}

{% set page_title = 'Add Account' %}
{% set active_nav = 'accounts' %}
{% set formUrl = url('dashboard.accounts.add') %}

{% if account %}
  {% set page_title = 'Edit Account' %}
    {% set formUrl = url('dashboard.accounts.edit', { id: account.id }) %}
{% endif %}

{% block subcontent %}
  <div class="row page-heading">
    <div class="large-6 columns">
      <h4>{{ page_title }}</h4>
    </div>
  </div>

  <div class="row page-content">
    <div class="large-4 columns">
      {% if old('errors') %}
        {% for error in old('errors') %}
          <div class="callout alert small" data-closable>
            <small>{{ error.message | capitalize }}</small>
          </div>
        {% endfor %}
      {% endif %}

      <form action="{{ formUrl }}" method="post">
        {{ csrfField }}
        <div class="row">
          <div class="large-12 columns">
            <label>
              Name
              <input type="text" name="name" value="{{ old('name', account.name) }}" />
            </label>
          </div>
        </div>

        <div class="row">
          <div class="large-12 columns">
            <label>
              Username
              <input type="text" name="username" value="{{ old('username', account.username) }}" />
            </label>
          </div>
        </div>

        <div class="row">
          <div class="large-12 columns">
            <label>
              Password
              {% if account %}
                (leave blank if not changing)
              {% endif %}
              <input type="password" name="password" />
            </label>
          </div>
        </div>

        <div class="row">
          <div class="large-12 columns">
            <label>
              Confirm Password
              {% if account %}
                (leave blank if not changing)
              {% endif %}
              <input type="password" name="password_confirm" />
            </label>
          </div>
        </div>

        <div class="row">
          <div class="large-12 columns">
            <label>
              Role
              <select name="role_id">
                {% for role in roles.toJSON() %}
                  {% if old('role_id', account.role_id) == role.id %}
                    <option value="{{ role.id }}" selected>{{ role.name }}</option>
                  {% else %}
                    <option value="{{ role.id }}">{{ role.name }}</option>
                  {% endif %}
                {% endfor %}
              </select>
            </label>
          </div>
        </div>

        <div class="row">
          <div class="large-12 columns">
            <button type="submit" class="button">Create Account</button>
          </div>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
